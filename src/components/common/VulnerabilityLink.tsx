import { ExternalLink } from 'lucide-react';
import { cn } from "@/lib/utils";

interface VulnerabilityLinkProps {
  id: string;
  className?: string;
  showIcon?: boolean;
}

export function VulnerabilityLink({ id, className, showIcon = false }: VulnerabilityLinkProps) {
  const getLink = (id: string) => {
    const cleanId = id.trim().toUpperCase();
    if (cleanId.startsWith('CWE-')) {
      const cweId = cleanId.replace('CWE-', '');
      return `https://cwe.mitre.org/data/definitions/${cweId}.html`;
    }
    if (cleanId.startsWith('CVE-')) {
      return `https://nvd.nist.gov/vuln/detail/${cleanId}`;
    }
    if (cleanId.startsWith('GHSA-')) {
      return `https://github.com/advisories/${cleanId}`;
    }
    return null;
  };

  const url = getLink(id);

  if (!url) {
    return <span className={className}>{id}</span>;
  }

  return (
    <a
      href={url}
      target="_blank"
      rel="noopener noreferrer"
      className={cn("hover:underline inline-flex items-center gap-1", className)}
    >
      {id}
      {showIcon && <ExternalLink className="h-3 w-3" />}
    </a>
  );
}
